<html>
<head>
<title>ua_algebra.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ua_algebra.v</h1>

<div class="code" title="File: ua_algebra.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** This file defines [Algebra]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 2
Time: 0.455s">
<div class="time" style="width: 100%"></div>
<pre>Require Export
  Coq.Unicode.Utf8
  HoTT.Classes.implementations.ne_list
  HoTT.Classes.implementations.family_prod.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 5
Time: 0.012s">
<div class="time" style="width: 2.6373626373626%"></div>
<pre>

Require Import
  HoTT.Basics.Overture
  HoTT.Types.Record
  HoTT.Types.Sigma
  HoTT.Types.Arrow
  HoTT.Types.Forall
  HoTT.Types.Universe
  HoTT.HSet
  HoTT.Classes.interfaces.abstract_algebra
  HoTT.Classes.implementations.list.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Import ne_list.notations.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Declare Scope Algebra_scope.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Delimit Scope Algebra_scope with Algebra.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Open Scope Algebra_scope.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition SymbolType_internal : Type → Type := ne_list.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A [Signature] is used to characterise [Algebra]s. In particular
    a signature specifies which operations (functions) an algebra for
    the signature is expected to provide. A signature consists of
    - A type of [Sort]s. An algebra for the signature must provide
      a type for each [s : Sort].
    - A type of function symbols [Symbol]. For each function symbol
      [u : Symbol], an algebra for the signature must provide a
      corresponding operation.
    - The field [symbol_types σ u] indicates which type the operation
      corresponding to [u] should have. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 38
Time: 0.001s">
<div class="time" style="width: 0.21978021978022%"></div>
<pre>Record Signature : Type := BuildSignature
  { Sort : Type
  ; Symbol : Type
  ; symbol_types : Symbol → SymbolType_internal Sort }.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We have this implicit coercion allowing us to use a signature
    [σ:Signature] as a map [Symbol σ → SymbolType σ]
    (see [SymbolType] below). *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Coercion symbol_types : Signature &gt;-&gt; Funclass.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A single sorted [Signature] is a signature with [Sort = Unit]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 49
Time: 0.001s">
<div class="time" style="width: 0.21978021978022%"></div>
<pre>Definition BuildSingleSortedSignature (sym : Type) (arities : sym → nat)
  : Signature
  := BuildSignature Unit sym (ne_list.replicate_Sn tt o arities).</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Let [σ:Signature]. For each symbol [u : Symbol σ], [σ u]
    associates [u] to a [SymbolType σ]. This represents the required
    type of the algebra operation corresponding to [u]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition SymbolType (σ : Signature) : Type := ne_list (Sort σ).</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For [s : SymbolType σ], [cod_symboltype σ] is the codomain of the
    symbol type [s]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition cod_symboltype {σ} : SymbolType σ → Sort σ
  := ne_list.last.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For [s : SymbolType σ], [cod_symboltype σ] is the domain of the
    symbol type [s]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition dom_symboltype {σ} : SymbolType σ → list (Sort σ)
  := ne_list.front.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For [s : SymbolType σ], [cod_symboltype σ] is the arity of the
    symbol type [s]. That is the number [n:nat] of arguments of the
    [SymbolType σ]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 71
Time: 0.001s">
<div class="time" style="width: 0.21978021978022%"></div>
<pre>Definition arity_symboltype {σ} : SymbolType σ → nat
  := length o dom_symboltype.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** An [Algebra] must provide a family of [Carriers σ] indexed by
    [Sort σ]. These carriers are the "objects" (types) of the algebra. *)

(* [Carriers] is a notation because it will be used for an implicit
   coercion [Algebra &gt;-&gt; Funclass] below. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation Carriers σ := (Sort σ → Type).</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The function [Operation] maps a family of carriers [A : Carriers σ]
    and [w : SymbolType σ] to the corresponding function type.

    &lt;&lt;
      Operation A [:s1; s2; ...; sn; t:] = A s1 → A s2 → ... → A sn → A t
    &gt;&gt;

    where [[:s1; s2; ...; sn; t:] : SymbolType σ] is a symbol type
    with domain [[s1; s2; ...; sn]] and codomain [t]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 90
Time: 0.001s">
<div class="time" style="width: 0.21978021978022%"></div>
<pre>Fixpoint Operation {σ} (A : Carriers σ) (w : SymbolType σ) : Type
  := match w with
     | [:s:] =&gt; A s
     | s ::: w' =&gt; A s → Operation A w'
     end.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance trunc_operation `{Funext} {σ : Signature}
  (A : Carriers σ) {n} `{!∀ s, IsTrunc n (A s)} (w : SymbolType σ)
  : IsTrunc n (Operation A w).</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 99
Time: 0.005s">
<div class="time" style="width: 1.0989010989011%"></div>
<pre>
  induction w; apply (istrunc_trunctype_type (BuildTruncType n _)).</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 100
Time: 0.001s">
<div class="time" style="width: 0.21978021978022%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Uncurry of an [f : Operation A w], such that

    &lt;&lt;
      ap_operation f (x1,x2,...,xn) = f x1 x2 ... xn
    &gt;&gt;
*)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 109
Time: 0.004s">
<div class="time" style="width: 0.87912087912088%"></div>
<pre>Fixpoint ap_operation {σ} {A : Carriers σ} {w : SymbolType σ}
    : Operation A w →
      FamilyProd A (dom_symboltype w) →
      A (cod_symboltype w)
    := match w with
       | [:s:] =&gt; λ f _, f
       | s ::: w' =&gt; λ f '(x, l), ap_operation (f x) l
       end.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Funext for uncurried [Operation A w]. If

    &lt;&lt;
      ap_operation f (x1,x2,...,xn) = ap_operation g (x1,x2,...,xn)
    &gt;&gt;

    for all [(x1,x2,...,xn) : A s1 * A s2 * ... * A sn], then [f = g]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 125
Time: 0.009s">
<div class="time" style="width: 1.978021978022%"></div>
<pre>Fixpoint path_forall_ap_operation `{Funext} {σ : Signature}
  {A : Carriers σ} {w : SymbolType σ}
  : ∀ (f g : Operation A w),
    (∀ a : FamilyProd A (dom_symboltype w),
       ap_operation f a = ap_operation g a)
    -&gt; f = g
  := match w with
     | [:s:] =&gt; λ (f g : A s) p, p tt
     | s ::: w' =&gt;
         λ (f g : A s → Operation A w') p,
          path_forall f g
            (λ x, path_forall_ap_operation (f x) (g x) (λ a, p (x,a)))
     end.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** An [Algebra σ] for a signature [σ] consists of a family [carriers :
    Carriers σ] indexed by the sorts [s : Sort σ], and for each symbol
    [u : Symbol σ], an operation of type [Operation carriers (σ u)],
    where [σ u : SymbolType σ] is the symbol type of [u]. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 143
Time: 0.002s">
<div class="time" style="width: 0.43956043956044%"></div>
<pre>Record Algebra {σ : Signature} : Type := BuildAlgebra
  { carriers : Carriers σ
  ; operations : ∀ (u : Symbol σ), Operation carriers (σ u) }.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments Algebra : clear implicits.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments BuildAlgebra {σ} carriers operations.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We have a convenient implicit coercion from an algebra to the
    family of carriers. *)</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Coercion carriers : Algebra &gt;-&gt; Funclass.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** To find a path between two algebras [A B : Algebra σ] it suffices
    to find a path between the carriers and the operations. *)

</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 156
Time: 0.001s">
<div class="time" style="width: 0.21978021978022%"></div>
<pre>Lemma path_algebra {σ : Signature} (A B : Algebra σ)
  (p : carriers A = carriers B)
  (q : transport (λ X, ∀ u, Operation X (σ u)) p (operations A)
       = operations B)
  : A = B.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 161
Time: 0.002s">
<div class="time" style="width: 0.43956043956044%"></div>
<pre>
  destruct A,B.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl in *.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 162
Time: 0.001s">
<div class="time" style="width: 0.21978021978022%"></div>
<pre> by path_induction.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 162
Time: 0.002s">
<div class="time" style="width: 0.43956043956044%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 163
Time: 0.003s">
<div class="time" style="width: 0.65934065934066%"></div>
<pre>

Class IsTruncAlgebra (n : trunc_index) {σ : Signature} (A : Algebra σ)
  := trunc_carriers_algebra : ∀ (s : Sort σ), IsTrunc n (A s).</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance trunc_carriers_algebra.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation IsHSetAlgebra := (IsTruncAlgebra 0).</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance trunc_algebra_succ {σ : Signature} (A : Algebra σ)
  {n} `{!IsTruncAlgebra n A}
  : IsTruncAlgebra n.+1 A | 1000.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 175
Time: 0.012s">
<div class="time" style="width: 2.6373626373626%"></div>
<pre>
  intro; exact _.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Module algebra_notations.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Given [A : Algebra σ] and function symbol [u : Symbol σ], we use
    the notation [u ^^ A] to refer to the corresponding algebra
    operation of type [Operation A (σ u)]. *)

 </pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Notation "u ^^ A" := (operations A u)
                              (at level 60, no associativity)
                              : Algebra_scope.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End algebra_notations.</pre>
</div>
<div class="code" title="File: ua_algebra.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

